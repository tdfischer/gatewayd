#!/usr/bin/env node
var gatewayd = require('../');
var program = require('commander');
var cli = require(__dirname+'/../lib/cli');

process.env.DATABASE_URL = gatewayd.config.get('DATABASE_URL');

program
  .version('4.0.0')

program
  .command('start') 
  .description('start the gatewayd processes')
  .action(cli.startGateway.bind(program));

program
  .command('stop') 
  .description('stop the gatewayd processes')
  .action(cli.stopGateway);

program
  .command('reload') 
  .description('reload the gatewayd processes')
  .action(cli.reloadGateway);

program
  .command('config:get <key>') 
  .description('restart the gatewayd processes')
  .action(gatewayd.config.get);

program
  .command('config:set <key> <value>') 
  .description('restart the gatewayd processes')
  .action(function(key, value) {
    gatewayd.config.set(key, value);
    gatewayd.config.save(function(error) {
      if (error) { throw new Error(error) }
      console.log(key+'='+value);
    });
  });

program.parse(process.argv);

